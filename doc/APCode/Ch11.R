###################################################
### chunk number 1: setup
###################################################
#line 7 "Ch11.rnw"
source("GenericSettings.R")


###################################################
### chunk number 2: 
###################################################
#line 22 "Ch11.rnw"
sum(dbinom(7:10, size=10, prob=0.5))
pbinom(6, size=10, prob=0.5, lower.tail=FALSE)


###################################################
### chunk number 3: 
###################################################
#line 27 "Ch11.rnw"
sum(dbinom(8:10, size=10, prob=0.5))
pbinom(7, size=10, prob=0.5, lower.tail=FALSE)


###################################################
### chunk number 4: 
###################################################
#line 34 "Ch11.rnw"
p=0.5
n=100
s=sqrt(p*(1-p)/n)
pnorm(0.6, mean=p, sd=s, lower.tail=FALSE)
qnorm(0.95, mean=p, sd=s, lower.tail=FALSE)


###################################################
### chunk number 5: 
###################################################
#line 44 "Ch11.rnw"
p=0.5
n=203
s=sqrt(p*(1-p)/n)
pnorm(87/203, mean=p, sd=s, lower.tail=FALSE)


###################################################
### chunk number 6: 
###################################################
#line 50 "Ch11.rnw"
binom.test(87,203, alternative="less")


###################################################
### chunk number 7: 
###################################################
#line 53 "Ch11.rnw"
prop.test(87,203, alternative="less")


###################################################
### chunk number 8: 
###################################################
#line 56 "Ch11.rnw"
prop.test(87,203, , alternative="less", correct=FALSE)


###################################################
### chunk number 9: 
###################################################
#line 63 "Ch11.rnw"
binom.test(68,400, p=0.2, alternative="less")


###################################################
### chunk number 10: 
###################################################
#line 66 "Ch11.rnw"
prop.test(68,400, p=0.2, alternative="less")


###################################################
### chunk number 11: 
###################################################
#line 69 "Ch11.rnw"
prop.test(68,400, p=0.2, alternative="less", correct=FALSE)


###################################################
### chunk number 12: 
###################################################
#line 75 "Ch11.rnw"
prop.test(c(65,51), c(111,92))


###################################################
### chunk number 13: 
###################################################
#line 83 "Ch11.rnw"
Ex11.11 = matrix(c(10,37,11,54), nrow=2)
Ex11.11


###################################################
### chunk number 14: 
###################################################
#line 88 "Ch11.rnw"
prop.test(c(10,11), c(47,65))


###################################################
### chunk number 15: 
###################################################
#line 92 "Ch11.rnw"
chisq.test(Ex11.11)


###################################################
### chunk number 16: 
###################################################
#line 95 "Ch11.rnw"
fisher.test(Ex11.11)


###################################################
### chunk number 17: 
###################################################
#line 100 "Ch11.rnw"
fisher.test(Ex11.11, alternative="greater")


###################################################
### chunk number 18: 
###################################################
#line 107 "Ch11.rnw"
data(GoGoGo, package="MindOnStats")


###################################################
### chunk number 19: 
###################################################
#line 111 "Ch11.rnw"
AmberLights = GoGoGo$Time[GoGoGo$Lights=="amber"]
t.test(AmberLights, mu=3.6, alternative="less")


###################################################
### chunk number 20: 
###################################################
#line 122 "Ch11.rnw"
Airport=c(283591,269620,312220,300679,217889,381030,232288,186285,230672,248172,221898,257073)
City=c(188010,197874,193954,210545,212116,277022,239715,197761,256650,182655,146602,149663)
t.test(Airport, City, paired=T)


###################################################
### chunk number 21: 
###################################################
#line 128 "Ch11.rnw"
Difference=Airport-City
t.test(Difference)


###################################################
### chunk number 22: 
###################################################
#line 138 "Ch11.rnw"
t.test(Time~Lights, data=GoGoGo)


###################################################
### chunk number 23: 
###################################################
#line 146 "Ch11.rnw"
data(Reflexes, package="MindOnStats")
attach(Reflexes)
wilcox.test(RightFluoro,RightClear, paired=TRUE, alternative="less")
detach(Reflexes)


###################################################
### chunk number 24: 
###################################################
#line 155 "Ch11.rnw"
wilcox.test(RightFluoro~Gender, data=Reflexes)


###################################################
### chunk number 25: 
###################################################
#line 165 "Ch11.rnw"
TestVal=28*0.25/0.35
pchisq(20 ,df=28)


###################################################
### chunk number 26: 
###################################################
#line 171 "Ch11.rnw"
pf(4/2.25, df1=9, df2=14, lower.tail=FALSE)


###################################################
### chunk number 27: 
###################################################
#line 194 "Ch11.rnw"
power.t.test(delta=0.5, sd=1, sig.level=0.05, power=0.8, type="one.sample", alternative="one.sided")


###################################################
### chunk number 28: 
###################################################
#line 200 "Ch11.rnw"
power.t.test(n=20, delta=0.8, sd=1, sig.level=0.05, type="one.sample", alternative="one.sided")


